# Docmost Management Script

Этот репозиторий содержит Bash-скрипт для управления приложением **Docmost**. Скрипт позволяет:
- **Получать ссылку на приглашение** для регистрации пользователей,
- **Удалять пользователей** из базы данных,
- **Устанавливать и настраивать Docmost** с использованием Docker.

---

## Содержание
- [Особенности](#особенности)
- [Требования](#требования)
- [Установка](#установка)
- [Использование](#использование)
  - [Получение ссылки на приглашение](#получение-ссылки-на-приглашение)
  - [Удаление пользователя](#удаление-пользователя)
  - [Установка Docmost](#установка-docmost)
- [Настройка](#настройка)
- [Вклад и улучшения](#вклад-и-улучшения)
- [Лицензия](#лицензия)

---

## Особенности

- **Цветной вывод:** Скрипт использует цветное форматирование для удобного восприятия информации.
- **Проверка зависимостей:** Перед выполнением операций производится проверка наличия необходимых контейнеров.
- **Работа с Docker:** Использует команды `docker exec` для взаимодействия с базой данных внутри контейнера `docmost-db-1`.
- **Интерактивное меню:** Пользователь может выбрать нужное действие через понятное меню.

---

## Требования

- **Bash:** Скрипт написан на Bash и требует Unix-подобной системы.
- **Docker:** Для работы с контейнерами, в частности с `docmost-db-1`.
- **PostgreSQL:** Для выполнения SQL-запросов внутри контейнера.

---

## Установка

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/snhplayer/docmost_helper.git
   cd docmost_helper
   ```

2. **Дайте права на выполнение скрипта (если необходимо):**

   ```bash
   chmod +x docmost_helper.sh
   ```

3. **Запустите скрипт:**

   ```bash
   ./docmost_helper.sh
   ```

---

## Использование

При запуске скрипта откроется главное меню с четырьмя опциями:

### Получение ссылки на приглашение

- **Описание:** Генерирует ссылку для приглашения пользователя на сайт.
- **Использование:** При выборе опции введите URL сайта (например, `https://yoursite.com`) и email пользователя.
- **Пример:**  
  ```bash
  Введите URL сайта (например, https://yoursite.com): https://example.com
  Введите email пользователя: user@example.com
  ```
- **Замечание:** Скрипт проверяет наличие запущенного контейнера `docmost-db-1` и наличие пользователя в таблице `workspace_invitations`.

### Удаление пользователя

- **Описание:** Удаляет пользователя из базы данных Docmost.
- **Использование:** При выборе опции введите email пользователя, которого необходимо удалить.
- **Пример:**  
  ```bash
  Введите email пользователя для удаления: user@example.com
  ```
- **Особенности:**  
  - Выполняется поиск ID пользователя.
  - Производится проверка на наличие связанных данных.
  - Связанные ссылки обновляются на `NULL` перед удалением.
  - После удаления производится финальная проверка.

### Установка Docmost

- **Описание:** Автоматически устанавливает Docker и настраивает приложение Docmost.
- **Использование:** При выборе опции происходит:
  1. Установка Docker и зависимостей.
  2. Создание директории `docmost` и загрузка файла `docker-compose.yml`.
  3. Генерация `APP_SECRET` и запрос домена.
  4. Запрос безопасного пароля для PostgreSQL.
  5. Запуск приложения с помощью Docker Compose.
- **Пример:**  
  Следуйте интерактивным подсказкам скрипта для ввода домена и пароля.

---

## Настройка

- **Изменение параметров:**  
  Все ключевые параметры (например, `APP_URL`, `APP_SECRET`, `POSTGRES_PASSWORD`) настраиваются автоматически через интерактивные запросы или через изменения в файле `docker-compose.yml`.
  
- **Контейнеры Docker:**  
  Убедитесь, что контейнер с именем `docmost-db-1` запущен перед использованием функций получения ссылки и удаления пользователя.

---

## Вклад и улучшения

Мы приветствуем вклад в проект! Если у вас есть идеи по улучшению или вы нашли ошибку, пожалуйста, создайте issue или отправьте pull request.

1. **Fork** репозиторий.
2. Создайте свою ветку (`git checkout -b feature/your-feature`).
3. Внесите изменения и **commit** их (`git commit -m 'Добавил новую функциональность'`).
4. Отправьте ветку (`git push origin feature/your-feature`).
5. Откройте Pull Request.

---

## Лицензия

Этот проект распространяется под [MIT License](LICENSE).
